### (p. 69, GC) 처리율 제한 장치를 미들웨어로 뒀을 때, 미들웨어가 SPOF가 되지 않을까?

처리율 제한 장치(미들웨어)를 두면, 클라이언트가 미들웨어로 api를 쏠텐데, 그렇다면 미들웨어가 죽으면 문제가 발생하지 않는가?

-   미들웨어가 단일 서버로 운영되는 경우, 미들웨어가 Single Point of Failure (SPOF)가 될 수 있음
-   미들웨어가 다운되면 클라이언트의 요청은 서버에 도달하지 못할 수 있다. 이를 방지하기 위해 미들웨어를 클러스터링하거나, 미들웨어를 다중화하는 방법이 있음
-   모니터링도 마찬가지지만, 시스템에서 핵심 기능을 담당하는 미들웨어는 다중화하는 것이 좋음
-   개발을 할때도 항상 스케일 업만이 아닌 스케일 아웃을 고려해야함

<br/>

### (p. 71, SM) Redis Sorted Set이 어떻게 락(Lock)의 경쟁 조건 이슈 해결 기능을 대체할 수 있는가?

> Better Rate Limiting with Redis Sorted Sets:
> https://engineering.classdojo.com/blog/2015/02/06/rolling-rate-limiter/ > https://www.npmjs.com/package/rolling-rate-limiter
>
> -   일반적인 Rate Limiter는 고정된 시간 단위로 작업의 허용량을 제한
> -   트래픽 패턴이 규칙적이지 않을 때, 고정된 시간 단위로 제한하는 방식은 공허한 시간과 급증한 트래픽을 처리하는 데 어려움
> -   Rolling Rate Limiter는 작업을 처리하는 시간 윈도우를 작은 구간으로 분할하여 시간에 따라 유동적으로 작업의 허용량을 조절
> -   각 구간은 허용 가능한 작업 수를 추적하고, 구간이 경과할 때마다 허용 가능한 작업 수를 조정
> -   각 구간은 일정 시간 단위로 이동하며, 구간 사이의 겹침을 통해 실시간 트래픽 변동에 유연하게 대응

-   본문에서 `락 대신 쓸 수 있는 해결책이 두 가지 있는데, 하나는 레디스의 Sorted Set을 사용하는 것이고, 다른 하나는 레디스의 Sorted Set을 사용하지 않는 것`이라고 언급
-   락과 Sorted Set은 별개의 개념이며, 락을 사용하여 경쟁 조건 문제를 해결하는 것이 일반적인 방법
-   레디스의 Sorted Set 기능은 동시성 제어와 직접적인 관련이 있는 것은 아님

<br/>

### (p. 71, GC) 작업 프로세스에서 규칙을 캐시 서버에 저장해두고 처리율 제한 미들웨어가 해당 캐시를 읽어서 처리를 한다. 이때, 만약 캐시가 오염되어있다면 어떻게 하는가?

처리율을 엄격하게 제한하는 서비스라고 가정하면, 이러한 부분도 고려해야할 것 같다.

-   캐시 오염은 제한된 처리율을 강제하는 서비스에서 특히 중요한 문제이므로, 캐시의 정확성과 유효성을 보장하기 위해 적절한 예방 및 대응 방안을 구현하는 것이 중요함
-   방안으로는 **유효성을 검사**하거나 캐시 오염을 감지 했을때 **캐시 무효화**, 데이터의 오염이 발생하면 백엄된 데이터를 사용하는 **백업 및 롤백** 등의 캐시 자동화 및 모니터링을 통한 캐시 오염 방지가 있음

레디스를 사용할 때 캐시 오염을 고려한다면,

-   일반적인 시스템의 캐시 오염과 레디스를 사용하는 경우의 캐시 오염은 개념적으로는 유사하지만, 구현 및 대응 방법에 차이가 있을 수 있음
-   레디스의 Replication 기능을 사용하면 캐시 오염에 대비하여 데이터의 백업을 유지할 수 있음
-   또한, Failover 기능을 사용하여 주 서버의 장애 시에 대비할 수 있음

> https://pulsar.apache.org/

-   Pulsar는 데이터의 영구 저장 및 처리에 중점을 둔 분산 시스템
-   Pulsar는 대규모 분산 시스템에서 실시간 메시징 및 이벤트 스트리밍을 지원합니다. 따라서 레디스보다 복잡한 메시지 패턴이나 이벤트 기반 아키텍처를 구축해야 하는 경우 Pulsar가 더 적합
-   Pulsar는 레디스와는 다른 목적과 기능을 가지고 있으며, 특정 문제를 해결하기 위해 레디스로는 한계가 있는 경우 Pulsar를 고려하는 것이 대안이 될 수 있음

<br/>

### (p. 72, GC) 처리율 제한 장치를 다중화 했을 때, 한 장치가 죽었다면 Failover는 어떻게 할 수 있을까?

-   로드 밸런서: 로드 밸런서를 사용하여 클라이언트의 요청을 여러 처리율 제한 장치로 분산시킬 수 있음, 이를 통해 장애 발생 시 다른 장치로 자동으로 트래픽을 전달할 수 있음
-   클러스터링: 처리율 제한 장치를 클러스터로 구성하여 여러 대의 장치를 함께 동작시킬 수 있음, 클러스터 내의 다른 장치가 장애 발생 시 자동으로 역할을 대신하도록 설정할 수 있음

<br/>

### (p. 72, GC) 분산 데이터 저장소가 중앙 집중형 데이터 저장소보다 좋은 점은 없을까?

-   그림 4-16 에서 표현이 단일 레디스 저장소로 표현되어 있지만, 당연히 레디스를 구성할 때도, 다중화를 고려한 구성이면 좋음
